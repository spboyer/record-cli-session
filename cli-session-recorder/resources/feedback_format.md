# Feedback Output Format Specification

This document defines the **required** output format for CLI session feedback files.

## ⚠️ MANDATORY FORMAT

Every report MUST use this exact structure. This is the canonical format - do not deviate.

## Required Document Structure

```markdown
## Copilot CLI Session Feedback

## Session Info

| Field | Value |
|-------|-------|
| **Session ID** | `uuid-or-timestamp-id` |
| **Duration** | ~X minutes (HH:MM - HH:MM UTC) |
| **Date** | YYYY-MM-DD |
| **OS** | Darwin 24.6.0 (macOS) / Linux / Windows |
| **Terminal** | iTerm.app / Terminal / etc. |
| **Copilot Version** | 0.0.400-0 |

## Environment

- **Python**: 3.x.x
- **Node.js**: vXX.x.x
- **Git**: X.x.x
- **GitHub CLI**: X.x.x
- **Azure CLI**: Installed/Not installed
- **Azure Developer CLI (azd)**: X.x.x

## Task Summary

**Goal**: [Clear description of what the user was trying to accomplish]

**Outcome**: ✅ SUCCESS / ❌ FAILED / ⚠️ PARTIAL - [Brief description]

---

## Detailed Tool Calls & Responses

### Exchange 1: [Descriptive Title]

**User Prompt**: "[Exact verbatim user input]"

#### Tool Call 1.1: bash

\```
Command: [exact command]
Result: [full output]
Exit Code: 0
\```

#### Tool Call 1.2: view

\```
Parameters: { "path": "/full/path/to/file" }
Result: [file contents or summary if very long]
\```

#### Tool Call 1.3: edit

\```
Parameters: { "path": "/path/to/file", "old_str": "...", "new_str": "..." }
Result: File updated successfully
\```

### Exchange 2: [Descriptive Title]

**User Prompt**: "[Exact verbatim user input]"

#### Tool Call 2.1: bash (FAILED)

\```
Command: [command that failed]
Result: 
ERROR: [full error message]
Exit Code: 1
\```

#### Tool Call 2.2: edit (FIX)

\```
Action: [What was done to fix]
Result: [Success confirmation]
\```

[Continue for all exchanges...]

---

## Files Created

| File | Purpose | Size |
|------|---------|------|
| `path/to/file.py` | Description of purpose | ~X KB |
| `path/to/config.yaml` | Configuration for X | ~X B |

## Resources Deployed (if applicable)

| Resource Type | Name | Region |
|--------------|------|--------|
| Resource Group | rg-name | eastus2 |
| Function App | func-name | eastus2 |
| Storage Account | stname | eastus2 |

## Errors & Fixes

| Error | Location | Fix Applied |
|-------|----------|-------------|
| Error message summary | filename.ext:line | Description of fix |
| Another error | another-file.ext | How it was resolved |

## Statistics

| Metric | Value |
|--------|-------|
| Total Tool Calls | XX |
| bash commands | XX |
| file creates | XX |
| file edits | XX |
| file views | XX |
| ask_user prompts | XX |
| skills loaded | XX |
| Errors encountered | XX |
| Errors fixed | XX |

---

_Generated by Copilot CLI Session Recorder_
```

## Key Requirements

### 1. Session Info Table
- Always use table format with Field/Value columns
- Include: Session ID, Duration, Date, OS, Terminal, Copilot Version

### 2. Environment Section  
- List all detected tools and versions
- Mark as "Installed" or "Not installed" for tools without version info

### 3. Task Summary
- **Goal**: Single clear sentence describing intent
- **Outcome**: Use emoji indicators (✅ ❌ ⚠️) followed by status and brief description

### 4. Detailed Tool Calls (CRITICAL)
- **EVERY tool call must be documented**
- Group by Exchange (user prompt/response pair)
- Number sequentially: Exchange 1 → Tool Call 1.1, 1.2, 1.3...
- Include descriptive titles for exchanges
- Show exact user prompts in quotes
- For each tool call show:
  - Tool name (with FAILED/FIX annotations as needed)
  - Command or Parameters
  - Full Result or Error
  - Exit Code for bash commands

### 5. Files Created Table
- List all files created during session
- Include path, purpose, and approximate size

### 6. Resources Deployed (conditional)
- Only include if Azure/cloud resources were deployed
- List resource type, name, and region

### 7. Errors & Fixes Table
- Document every error encountered
- Show location and how it was resolved

### 8. Statistics Table
- Break down tool calls by type
- Show errors encountered vs fixed

## File Naming

```
feedback-YYYY-MM-DD-HHMM.md
```

Example: `feedback-2026-01-30-2043.md`

## Sensitive Data

The recorder automatically scrubs:
- API keys and secrets
- Bearer tokens  
- GitHub PATs (ghp_...)
- OpenAI keys (sk-...)
- Azure subscription IDs (partial redaction)

Custom patterns can be added via `scrub_sensitive_data()`.
